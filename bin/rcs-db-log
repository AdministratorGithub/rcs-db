#!/usr/bin/env ruby

# ensure the working dir is correct
Dir.chdir File.dirname(File.dirname(File.realpath(__FILE__)))

# list of logs to be opened
logs = []

last_log = Dir['log/rcs-db**'].max
unless last_log.nil?
  logs << last_log
  logs << File.join('log/err', File.basename(last_log))
end

last_log = Dir['log/rcs-worker**'].max
unless last_log.nil?
  logs << last_log
  logs << File.join('log/err', File.basename(last_log))
end

last_log = Dir['log/rcs-aggregator**'].max
unless last_log.nil?
  logs << last_log
  logs << File.join('log/err', File.basename(last_log))
end

last_log = Dir['log/rcs-intelligence**'].max
unless last_log.nil?
  logs << last_log
  logs << File.join('log/err', File.basename(last_log))
end

spawn "bin/baretail.exe " + logs.join(" ")