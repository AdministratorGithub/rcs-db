#
# Controller for the list of exploits
#

require_relative '../build/exploit'

module RCS
module DB

class ExploitController < RESTController

  def index
    require_auth_level :tech

    exploits = Exploit.all

    exploits.sort! {|x,y| x['name'] <=> y['name']}

    exploits.each do |e|
      e['format'] = [e['format']]
      puts e['format'].inspect
    end

    ok(exploits)
  end

end

end #DB::
end #RCS::